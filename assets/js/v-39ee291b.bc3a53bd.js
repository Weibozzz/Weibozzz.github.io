(self.webpackChunkweiboqianduan=self.webpackChunkweiboqianduan||[]).push([[6810],{2399:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>t});const t={key:"v-39ee291b",path:"/React/10%E5%88%86%E9%92%9F%E4%BA%86%E8%A7%A3react%E6%96%B0%E7%89%B9%E6%80%A7hooks.html",title:"10分钟了解react新特性hooks",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"Hook 简介",slug:"hook-简介",children:[]},{level:2,title:"useState",slug:"usestate",children:[]},{level:2,title:"Effect Hook",slug:"effect-hook",children:[]},{level:2,title:"Hook 使用规则",slug:"hook-使用规则",children:[]},{level:2,title:"自定义 Hook",slug:"自定义-hook",children:[]},{level:2,title:"其他Hooks",slug:"其他hooks",children:[]},{level:2,title:"摘自",slug:"摘自",children:[]},{level:2,title:"今日图 - 我喜欢你 React",slug:"今日图-我喜欢你-react",children:[]}],filePathRelative:"React/10分钟了解react新特性hooks.md",git:{updatedTime:1627026748e3}}},1894:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>K});var t=a(6252);const e=a.p+"assets/img/pkpjg.450d0afa.gif",o=(0,t.Wm)("h1",{id:"_10分钟了解react新特性hooks",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#_10分钟了解react新特性hooks","aria-hidden":"true"},"#"),(0,t.Uk)(" 10分钟了解react新特性hooks")],-1),c=(0,t.Wm)("h2",{id:"hook-简介",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#hook-简介","aria-hidden":"true"},"#"),(0,t.Uk)(" Hook 简介")],-1),l=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 是 "),(0,t.Wm)("code",null,"React 16.8"),(0,t.Uk)(" 的新增特性。它可以让你在不编写 "),(0,t.Wm)("code",null,"class"),(0,t.Uk)(" 的情况下使用 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 以及其他的 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 特性。")],-1),p=(0,t.Wm)("h2",{id:"usestate",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#usestate","aria-hidden":"true"},"#"),(0,t.Uk)(" useState")],-1),m=(0,t.Wm)("p",null,"这个例子用来显示一个计数器。当你点击按钮，计数器的值就会增加：",-1),k=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" React"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" useState "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"Example"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 声明一个新的叫做 “count” 的 state 变量"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setCount"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("p"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("You clicked "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(" times"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("p"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("button onClick"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"setCount"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("count "),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n        Click me\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("button"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br")])],-1),u=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"useState"),(0,t.Uk)(" 唯一的参数就是初始 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)("。在上面的例子中，我们的计数器是从零开始的，所以初始 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 就是 0。")],-1),W=(0,t.Wm)("h4",{id:"声明多个-state-变量",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#声明多个-state-变量","aria-hidden":"true"},"#"),(0,t.Uk)(" 声明多个 state 变量")],-1),r=(0,t.Wm)("p",null,[(0,t.Uk)("你可以在一个组件中多次使用 "),(0,t.Wm)("code",null,"State Hook"),(0,t.Uk)(":")],-1),i=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"ExampleWithManyStates"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// 声明多个 state 变量！"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("age"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setAge"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"42"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("fruit"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setFruit"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token string"},"'banana'"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("todos"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setTodos"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" text"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Learn Hooks'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token comment"},"// ..."),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br")])],-1),U=(0,t.Wm)("h2",{id:"effect-hook",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#effect-hook","aria-hidden":"true"},"#"),(0,t.Uk)(" Effect Hook")],-1),b=(0,t.Wm)("p",null,[(0,t.Uk)("你之前可能已经在 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 组件中执行过数据获取、订阅或者手动修改过 "),(0,t.Wm)("code",null,"DOM"),(0,t.Uk)("。我们统一把这些操作称为“副作用”，或者简称为“作用”。")],-1),d=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"useEffect"),(0,t.Uk)(" 就是一个 "),(0,t.Wm)("code",null,"Effect Hook"),(0,t.Uk)("，给函数组件增加了操作副作用的能力。它跟 "),(0,t.Wm)("code",null,"class"),(0,t.Uk)(" 组件中的 "),(0,t.Wm)("code",null,"componentDidMount"),(0,t.Uk)("、"),(0,t.Wm)("code",null,"componentDidUpdate"),(0,t.Uk)(" 和 "),(0,t.Wm)("code",null,"componentWillUnmount"),(0,t.Uk)(" 具有相同的用途，只不过被合并成了一个 "),(0,t.Wm)("code",null,"API"),(0,t.Uk)("。")],-1),f=(0,t.Wm)("p",null,[(0,t.Uk)("可以通知 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 跳过对 "),(0,t.Wm)("code",null,"effect"),(0,t.Uk)(" 的调用，只要传递数组作为 "),(0,t.Wm)("code",null,"useEffect"),(0,t.Uk)(" 的第二个可选参数即可：")],-1),h=(0,t.Wm)("p",null,[(0,t.Uk)("例如，下面这个组件在 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 更新 "),(0,t.Wm)("code",null,"DOM"),(0,t.Uk)(" 后会设置一个页面标题：")],-1),g=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" React"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" useState"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" useEffect "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"Example"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setCount"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token comment"},"// 相当于 componentDidMount 和 componentDidUpdate:"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token function"},"useEffect"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token comment"},"// 使用浏览器的 API 更新页面标题"),(0,t.Uk)("\n    document"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("title "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token template-string"},[(0,t.Wm)("span",{class:"token template-punctuation string"},"`"),(0,t.Wm)("span",{class:"token string"},"You clicked "),(0,t.Wm)("span",{class:"token interpolation"},[(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t.Wm)("span",{class:"token string"}," times"),(0,t.Wm)("span",{class:"token template-punctuation string"},"`")]),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token comment"},"// 仅在 count 更改时更新"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("p"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("You clicked "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(" times"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("p"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("button onClick"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"setCount"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("count "),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n        Click me\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("button"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("div"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br")])],-1),w=(0,t.Wm)("p",null,[(0,t.Uk)("当你调用 "),(0,t.Wm)("code",null,"useEffect"),(0,t.Uk)(" 时，就是在告诉 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 在完成对 "),(0,t.Wm)("code",null,"DOM"),(0,t.Uk)(" 的更改后运行你的“副作用”函数。由于副作用函数是在组件内声明的，所以它们可以访问到组件的 "),(0,t.Wm)("code",null,"props"),(0,t.Uk)(" 和 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)("。默认情况下，"),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 会在每次渲染后调用副作用函数 —— 包括第一次渲染的时候。")],-1),y=(0,t.Wm)("p",null,"**副作用函数还可以通过返回一个函数来指定如何“清除”副作用。**例如，在下面的组件中使用副作用函数来订阅好友的在线状态，并通过取消订阅来进行清除操作：",-1),v=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" React"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" useState"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" useEffect "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"FriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"props"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("isOnline"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setIsOnline"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"status"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"setIsOnline"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("status"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("isOnline"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token function"},"useEffect"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    ChatAPI"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"subscribeToFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("friend"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      ChatAPI"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"unsubscribeFromFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("friend"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("isOnline "),(0,t.Wm)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Loading...'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" isOnline "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Online'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Offline'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br")])],-1),S=(0,t.Wm)("p",null,[(0,t.Uk)("在这个示例中，"),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 会在组件销毁或者后续渲染重新执行副作用函数时取消对 "),(0,t.Wm)("code",null,"ChatAPI"),(0,t.Uk)(" 的订阅。（如果传给 "),(0,t.Wm)("code",null,"ChatAPI"),(0,t.Uk)(" 的 "),(0,t.Wm)("code",null,"props.friend.id"),(0,t.Uk)(" 没有变化，你也可以告诉 "),(0,t.Wm)("code",null,"React"),(0,t.Uk)(" 跳过重新订阅。）")],-1),C=(0,t.Wm)("h2",{id:"hook-使用规则",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#hook-使用规则","aria-hidden":"true"},"#"),(0,t.Uk)(" Hook 使用规则")],-1),H=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 就是 "),(0,t.Wm)("code",null,"JavaScript"),(0,t.Uk)(" 函数，但是使用它们会有两个额外的规则：")],-1),j=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"只能在函数最外层调用 Hook。不要在循环、条件判断或者子函数中调用。"),(0,t.Wm)("li",null,"只能在 React 的函数组件中调用 Hook。不要在其他 JavaScript 函数中调用。")],-1),x=(0,t.Wm)("h2",{id:"自定义-hook",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#自定义-hook","aria-hidden":"true"},"#"),(0,t.Uk)(" 自定义 Hook")],-1),E=(0,t.Wm)("p",null,[(0,t.Uk)("有时候我们会想要在组件之间重用一些状态逻辑。目前为止，有两种主流方案来解决这个问题：高阶组件和 "),(0,t.Wm)("code",null,"render props"),(0,t.Uk)("。自定义 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 可以让你在不增加组件的情况下达到同样的目的。")],-1),R=(0,t.Wm)("p",null,[(0,t.Uk)("前面，我们介绍了一个叫 "),(0,t.Wm)("code",null,"FriendStatus"),(0,t.Uk)(" 的组件，它通过调用 "),(0,t.Wm)("code",null,"useState"),(0,t.Uk)(" 和 "),(0,t.Wm)("code",null,"useEffect"),(0,t.Uk)(" 的 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 来订阅一个好友的在线状态。假设我们想在另一个组件里重用这个订阅逻辑。")],-1),O=(0,t.Wm)("p",null,[(0,t.Uk)("首先，我们把这个逻辑抽取到一个叫做 "),(0,t.Wm)("code",null,"useFriendStatus"),(0,t.Uk)(" 的自定义 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 里：")],-1),I=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"import"),(0,t.Uk)(" React"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" useState"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" useEffect "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"from"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'react'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"friendID"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("isOnline"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" setIsOnline"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useState"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"status"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token function"},"setIsOnline"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("status"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("isOnline"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token function"},"useEffect"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    ChatAPI"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"subscribeToFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("friendID"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      ChatAPI"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Wm)("span",{class:"token function"},"unsubscribeFromFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("friendID"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" handleStatusChange"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" isOnline"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br")])],-1),F=(0,t.Wm)("p",null,[(0,t.Uk)("它将 "),(0,t.Wm)("code",null,"friendID"),(0,t.Uk)(" 作为参数，并返回该好友是否在线：")],-1),A=(0,t.Wm)("p",null,"现在我们可以在两个组件中使用它：",-1),D=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"FriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"props"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" isOnline "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("friend"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("isOnline "),(0,t.Wm)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"null"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Loading...'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(" isOnline "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Online'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'Offline'"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"FriendListItem"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},"props"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" isOnline "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useFriendStatus"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("friend"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("li style"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" color"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" isOnline "),(0,t.Wm)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'green'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'black'"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("props"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("friend"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("name"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("li"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br")])],-1),P=(0,t.Wm)("p",null,[(0,t.Uk)("这两个组件的 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 是完全独立的。"),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 是一种复用状态逻辑的方式，它不复用 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 本身。事实上 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 的每次调用都有一个完全独立的 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" —— 因此你可以在单个组件中多次调用同一个自定义 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)("。")],-1),M=(0,t.Wm)("p",null,[(0,t.Uk)("自定义 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)(" 更像是一种约定而不是功能。如果函数的名字以 "),(0,t.Wm)("code",null,"“use”"),(0,t.Uk)(" 开头并调用其他 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)("，我们就说这是一个自定义 "),(0,t.Wm)("code",null,"Hook"),(0,t.Uk)("。")],-1),L=(0,t.Wm)("h2",{id:"其他hooks",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#其他hooks","aria-hidden":"true"},"#"),(0,t.Uk)(" 其他Hooks")],-1),T=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"useReducer")],-1),Y=(0,t.Wm)("p",null,[(0,t.Wm)("code",null,"useState"),(0,t.Uk)(" 的替代方案。它接收一个形如 "),(0,t.Wm)("code",null,"(state, action) => newState"),(0,t.Uk)(" 的 "),(0,t.Wm)("code",null,"reducer"),(0,t.Uk)("，并返回当前的 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 以及与其配套的 "),(0,t.Wm)("code",null,"dispatch"),(0,t.Uk)(" 方法。（如果你熟悉 "),(0,t.Wm)("code",null,"Redux"),(0,t.Uk)(" 的话，就已经知道它如何工作了。）")],-1),B=(0,t.Wm)("p",null,[(0,t.Uk)("在某些场景下，"),(0,t.Wm)("code",null,"useReducer"),(0,t.Uk)(" 会比 "),(0,t.Wm)("code",null,"useState"),(0,t.Uk)(" 更适用，例如 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 逻辑较复杂且包含多个子值，或者下一个 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 依赖于之前的 "),(0,t.Wm)("code",null,"state"),(0,t.Uk)(" 等。并且，使用 "),(0,t.Wm)("code",null,"useReducer"),(0,t.Uk)(" 还能给那些会触发深更新的组件做性能优化，因为你可以向子组件传递 dispatch 而不是回调函数 。")],-1),q=(0,t.Wm)("p",null,[(0,t.Uk)("以下是用 "),(0,t.Wm)("code",null,"reducer"),(0,t.Uk)(" 重写 "),(0,t.Wm)("code",null,"useState"),(0,t.Uk)(" 计数器示例：")],-1),z=(0,t.Wm)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Wm)("pre",{class:"language-javascript"},[(0,t.Wm)("code",null,[(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(" initialState "),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"0"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"reducer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token parameter"},[(0,t.Uk)("state"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" action")]),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"switch"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("action"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("type"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"case"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'increment'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" state"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("count "),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"case"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'decrement'"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(" state"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("count "),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token number"},"1"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token keyword"},"default"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token keyword"},"throw"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token class-name"},"Error"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t.Wm)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"Counter"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"["),(0,t.Uk)("state"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" dispatch"),(0,t.Wm)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"useReducer"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("reducer"),(0,t.Wm)("span",{class:"token punctuation"},","),(0,t.Uk)(" initialState"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      Count"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("state"),(0,t.Wm)("span",{class:"token punctuation"},"."),(0,t.Uk)("count"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("button onClick"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"dispatch"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("type"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'increment'"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Wm)("span",{class:"token operator"},"+"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("button"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n      "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Uk)("button onClick"),(0,t.Wm)("span",{class:"token operator"},"="),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token function"},"dispatch"),(0,t.Wm)("span",{class:"token punctuation"},"("),(0,t.Wm)("span",{class:"token punctuation"},"{"),(0,t.Uk)("type"),(0,t.Wm)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t.Wm)("span",{class:"token string"},"'decrement'"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Wm)("span",{class:"token operator"},"-"),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Uk)("button"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n    "),(0,t.Wm)("span",{class:"token operator"},"<"),(0,t.Wm)("span",{class:"token operator"},"/"),(0,t.Wm)("span",{class:"token operator"},">"),(0,t.Uk)("\n  "),(0,t.Wm)("span",{class:"token punctuation"},")"),(0,t.Wm)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t.Wm)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n")])]),(0,t.Wm)("div",{class:"line-numbers"},[(0,t.Wm)("span",{class:"line-number"},"1"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"2"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"3"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"4"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"5"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"6"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"7"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"8"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"9"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"10"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"11"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"12"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"13"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"14"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"15"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"16"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"17"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"18"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"19"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"20"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"21"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"22"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"23"),(0,t.Wm)("br"),(0,t.Wm)("span",{class:"line-number"},"24"),(0,t.Wm)("br")])],-1),J=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"useContext")],-1),_=(0,t.Wm)("h2",{id:"摘自",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#摘自","aria-hidden":"true"},"#"),(0,t.Uk)(" 摘自")],-1),N=(0,t.Wm)("ul",null,[(0,t.Wm)("li",null,"https://zh-hans.reactjs.org/docs/hooks-intro.html")],-1),$=(0,t.Wm)("h2",{id:"今日图-我喜欢你-react",tabindex:"-1"},[(0,t.Wm)("a",{class:"header-anchor",href:"#今日图-我喜欢你-react","aria-hidden":"true"},"#"),(0,t.Uk)(" 今日图 - 我喜欢你 React")],-1),G=(0,t.Wm)("p",null,[(0,t.Wm)("img",{src:e,alt:"pkpjg.gif"})],-1),K={render:function(n,s){return(0,t.wg)(),(0,t.j4)(t.HY,null,[o,c,l,p,m,k,u,W,r,i,U,b,d,f,h,g,w,y,v,S,C,H,j,x,E,R,O,I,F,A,D,P,M,L,T,Y,B,q,z,J,_,N,$,G],64)}}}}]);