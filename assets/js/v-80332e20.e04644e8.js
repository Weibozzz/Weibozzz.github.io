"use strict";(self.webpackChunkweiboqianduan=self.webpackChunkweiboqianduan||[]).push([[4018],{8931:(n,s,e)=>{e.r(s),e.d(s,{data:()=>a});const a={key:"v-80332e20",path:"/Utils/Node/npm%E5%8F%91%E5%B8%83%E5%8C%85%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E6%B5%81%E7%A8%8B.html",title:"npm发布包一些注意事项和流程",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"初始化",slug:"初始化",children:[]},{level:2,title:"新建入口文件 index.js",slug:"新建入口文件-index-js",children:[]},{level:2,title:"发布",slug:"发布",children:[]},{level:2,title:"更新发布",slug:"更新发布",children:[{level:3,title:"1. version",slug:"_1-version",children:[]},{level:3,title:"2. npm version",slug:"_2-npm-version",children:[]},{level:3,title:"3. major | minor | patch 等",slug:"_3-major-minor-patch-等",children:[]}]},{level:2,title:"如果发布的有es6代码",slug:"如果发布的有es6代码",children:[]},{level:2,title:"错误",slug:"错误",children:[]},{level:2,title:"npm包来制作命令行工具的原理",slug:"npm包来制作命令行工具的原理",children:[{level:3,title:"Unix-like 平台",slug:"unix-like-平台",children:[]},{level:3,title:"Windows 平台",slug:"windows-平台",children:[]},{level:3,title:"本地开发 cli 测试",slug:"本地开发-cli-测试",children:[]}]},{level:2,title:"引用",slug:"引用",children:[]},{level:2,title:"今日图 - 猜猜这个是谁？",slug:"今日图-猜猜这个是谁",children:[]}],filePathRelative:"Utils/Node/npm发布包一些注意事项和流程.md",git:{updatedTime:1630569898e3}}},7105:(n,s,e)=>{e.r(s),e.d(s,{default:()=>cn});var a=e(6252),l=e(4919);const t=(0,a._)("h1",{id:"npm发布包一些注意事项和流程",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#npm发布包一些注意事项和流程","aria-hidden":"true"},"#"),(0,a.Uk)(" npm发布包一些注意事项和流程")],-1),o=(0,a._)("h2",{id:"初始化",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#初始化","aria-hidden":"true"},"#"),(0,a.Uk)(" 初始化")],-1),c=(0,a.Uk)("在"),p={href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"},r=(0,a.Uk)("https://www.npmjs.com/"),_=(0,a.Uk)("这里注册登录， 起一个名字，比如http-auth-zfb,首先查询是否已存在"),u=(0,a._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,a._)("pre",{class:"language-bash"},[(0,a._)("code",null,[(0,a._)("span",{class:"token function"},"mkdir"),(0,a.Uk)(" http-auth-zfb\n"),(0,a._)("span",{class:"token builtin class-name"},"cd"),(0,a.Uk)(" http-auth-zfb\n"),(0,a._)("span",{class:"token function"},"npm"),(0,a.Uk)(" init -y\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br")])],-1),i=(0,a._)("h2",{id:"新建入口文件-index-js",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#新建入口文件-index-js","aria-hidden":"true"},"#"),(0,a.Uk)(" 新建入口文件 index.js")],-1),k=(0,a._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,a._)("pre",{class:"language-javascript"},[(0,a._)("code",null,[(0,a._)("span",{class:"token comment"},"//index.js"),(0,a.Uk)("\nmodule"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("exports "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token function"},"require"),(0,a._)("span",{class:"token punctuation"},"("),(0,a._)("span",{class:"token string"},"'./lib/index'"),(0,a._)("span",{class:"token punctuation"},")"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br")])],-1),d=(0,a._)("p",null,"要发布的文件放到lib文件夹下",-1),m=(0,a._)("h2",{id:"发布",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#发布","aria-hidden":"true"},"#"),(0,a.Uk)(" 发布")],-1),U=(0,a._)("p",null,[(0,a._)("code",null,"npm login"),(0,a.Uk)("登录会填写你在"),(0,a._)("code",null,"npmjs.com"),(0,a.Uk)("注册的用户名密码邮箱等信息。")],-1),b=(0,a._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,a._)("pre",{class:"language-bash"},[(0,a._)("code",null,[(0,a._)("span",{class:"token function"},"npm"),(0,a.Uk)(" login\n"),(0,a._)("span",{class:"token function"},"npm"),(0,a.Uk)(" publish\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br")])],-1),h=(0,a._)("h2",{id:"更新发布",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#更新发布","aria-hidden":"true"},"#"),(0,a.Uk)(" 更新发布")],-1),g=(0,a._)("p",null,[(0,a.Uk)("只需要更改版本号然后"),(0,a._)("code",null,"npm publish"),(0,a.Uk)(" ,下面介绍几个自动更新版本号的")],-1),f=(0,a._)("h3",{id:"_1-version",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#_1-version","aria-hidden":"true"},"#"),(0,a.Uk)(" 1. version")],-1),v=(0,a._)("p",null,[(0,a.Uk)("每个npm包都有一个 "),(0,a._)("code",null,"package.json"),(0,a.Uk)("，如果要发布包的话，package.json里面的version字段就是决定发包的版本号了。")],-1),j=(0,a._)("p",null,[(0,a.Uk)("version字段是这样一个结构： ‘0.0.1’，是有三位的版本号。分别是对应的version里面的："),(0,a._)("code",null,"major"),(0,a.Uk)(", "),(0,a._)("code",null,"minor"),(0,a.Uk)(", "),(0,a._)("code",null,"patch"),(0,a.Uk)("。 也就是说当发布大版本的时候会升级为 "),(0,a._)("code",null,"1.0.0"),(0,a.Uk)("，小版本是"),(0,a._)("code",null,"0.1.0"),(0,a.Uk)("，一些小修复是"),(0,a._)("code",null,"0.0.2")],-1),y=(0,a._)("h3",{id:"_2-npm-version",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#_2-npm-version","aria-hidden":"true"},"#"),(0,a.Uk)(" 2. npm version")],-1),x=(0,a._)("p",null,[(0,a.Uk)("为了方便用户更改版本号，npm有"),(0,a._)("code",null,"npm version"),(0,a.Uk)("这个命令来自动更改版本号，同时帮忙commit. 比如说 当前版本是 "),(0,a._)("code",null,"1.1.1"),(0,a.Uk)("，当执行 "),(0,a._)("code",null,"npm version patch -m '[patch]'"),(0,a.Uk)("的时候，会自动把package.json里面的"),(0,a._)("code",null,"version"),(0,a.Uk)("改为"),(0,a._)("code",null,"1.1.2"),(0,a.Uk)("，同时git会多一个commit log "),(0,a._)("code",null,"[patch]"),(0,a.Uk)(",这次改动便是更改package.json。")],-1),w=(0,a._)("p",null,[(0,a.Uk)("如果执行了prepatch，版本号会从"),(0,a._)("code",null,"1.1.1"),(0,a.Uk)("变成 "),(0,a._)("code",null,"1.1.2-0")],-1),A=(0,a._)("ul",null,[(0,a._)("li",null,[(0,a.Uk)("我们称版本号的三位分别是 "),(0,a._)("code",null,"大号.中号.小号-预发布号")])],-1),E=(0,a._)("h3",{id:"_3-major-minor-patch-等",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#_3-major-minor-patch-等","aria-hidden":"true"},"#"),(0,a.Uk)(" 3. major | minor | patch 等")],-1),P=(0,a._)("table",null,[(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"npm version"),(0,a._)("th",{style:{"text-align":"right"}},"功能")])]),(0,a._)("tbody",null,[(0,a._)("tr",null,[(0,a._)("td",null,"major"),(0,a._)("td",{style:{"text-align":"right"}},"- 如果没有预发布号，则直接升级一位大号，其他位都置为0 - 如果有预发布号： -- 中号和小号都为0，则不升级大号，而将预发布号删掉。即2.0.0-1变成2.0.0，这就是预发布的作用 -- 如果中号和小号有任意一个不是0，那边会升级一位大号，其他位都置为0，清空预发布号。即 2.0.1-0变成3.0.0")]),(0,a._)("tr",null,[(0,a._)("td",null,"minor"),(0,a._)("td",{style:{"text-align":"right"}},"- 如果没有预发布号，则升级一位中号，大号不动，小号置为空 - 如果有预发布号: -- 如果小号为0，则不升级中号，将预发布号去掉 -- 如果小号不为0，同理没有预发布号")]),(0,a._)("tr",null,[(0,a._)("td",null,"patch"),(0,a._)("td",{style:{"text-align":"right"}},"- 如果没有预发布号：直接升级小号，去掉预发布号 - 如果有预发布号：去掉预发布号，其他不动")]),(0,a._)("tr",null,[(0,a._)("td",null,"premajor"),(0,a._)("td",{style:{"text-align":"right"}},"- 直接升级大号，中号和小号置为0，增加预发布号为0")]),(0,a._)("tr",null,[(0,a._)("td",null,"preminor"),(0,a._)("td",{style:{"text-align":"right"}},"- 直接升级中号，小号置为0，增加预发布号为0")]),(0,a._)("tr",null,[(0,a._)("td",null,"prepatch"),(0,a._)("td",{style:{"text-align":"right"}},"- 直接升级小号，增加预发布号为0")]),(0,a._)("tr",null,[(0,a._)("td",null,"prerelease"),(0,a._)("td",{style:{"text-align":"right"}},"- 如果没有预发布号：增加小号，增加预发布号为0 - 如果有预发布号，则升级预发布")])])],-1),R=(0,a._)("p",null,[(0,a._)("a",{href:""},"前端工具")],-1),W=(0,a._)("h2",{id:"如果发布的有es6代码",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#如果发布的有es6代码","aria-hidden":"true"},"#"),(0,a.Uk)(" 如果发布的有es6代码")],-1),B=(0,a._)("p",null,[(0,a.Uk)("新建"),(0,a._)("code",null,"src"),(0,a.Uk)("目录，把原始文件（es6代码），放入"),(0,a._)("code",null,"src"),(0,a.Uk)(",需要"),(0,a._)("code",null,"babael"),(0,a.Uk)("转化")],-1),D=(0,a._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,a._)("pre",{class:"language-json"},[(0,a._)("code",null,[(0,a._)("span",{class:"token property"},'"scripts"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"test"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"echo \\"Error: no test specified\\" && exit 1"'),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"build"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"babel src --out-dir lib"'),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n\n"),(0,a._)("span",{class:"token property"},'"devDependencies"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"babel-cli"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"^6.26.0"'),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"babel-plugin-transform-runtime"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"^6.23.0"'),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"babel-preset-es2015"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"^6.24.1"'),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"babel-preset-stage-3"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"^6.24.1"'),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token property"},'"dependencies"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token property"},'"transform-runtime"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"^0.0.0"'),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"6"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"7"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"8"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"9"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"10"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"11"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"12"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"13"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"14"),(0,a._)("br")])],-1),C=(0,a._)("p",null,[(0,a.Uk)("发布前，执行"),(0,a._)("code",null,"npm run build"),(0,a.Uk)("转化后的代码会在lib下面，更改版本号，在执行"),(0,a._)("code",null,"npm publish")],-1),Y=(0,a._)("h2",{id:"错误",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#错误","aria-hidden":"true"},"#"),(0,a.Uk)(" 错误")],-1),Z=(0,a._)("p",null,[(0,a._)("code",null,"npm ERR! publish Failed PUT 401"),(0,a.Uk)(" 解决过程：")],-1),q=(0,a._)("ol",null,[(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("检查仓库是否被设成了淘宝镜像库 "),(0,a._)("code",null,"npm config get registry")])]),(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("如是，则设回原仓库 "),(0,a._)("code",null,"npm config set registry=http://registry.npmjs.org")])]),(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("登录账号（如未登录） "),(0,a._)("code",null,"npm login"),(0,a.Uk)(" 或者添加用户 "),(0,a._)("code",null,"npm adduser")])]),(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("再次发布 "),(0,a._)("code",null,"npm publish")])]),(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("如发布成功，则再次将仓库地址设为淘宝镜像地址 "),(0,a._)("code",null,"npm config set registry=https://registry.npm.taobao.org/")])])],-1),z=(0,a._)("h2",{id:"npm包来制作命令行工具的原理",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#npm包来制作命令行工具的原理","aria-hidden":"true"},"#"),(0,a.Uk)(" npm包来制作命令行工具的原理")],-1),J=(0,a._)("blockquote",null,[(0,a._)("p",null,"用过构建工具的亲们知道，通常通过全局安装一个 xxx-cli 的 npm 包， 就能在命令行用命令进行构建。那么这个 npm 包如何变成一个可执行的命令呢？")],-1),N=(0,a._)("p",null,[(0,a.Uk)("1.使用 "),(0,a._)("code",null,"npm init"),(0,a.Uk)(" 初始化一个项目目录 "),(0,a._)("code",null,"my-cli"),(0,a.Uk)("。")],-1),T=(0,a._)("p",null,[(0,a.Uk)("2.在 "),(0,a._)("code",null,"package.json"),(0,a.Uk)(" 中添加或者编辑 "),(0,a._)("code",null,"bin"),(0,a.Uk)(" 字段：")],-1),V=(0,a._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,a._)("pre",{class:"language-text"},[(0,a._)("code",null,'{\n  "name": "my-cli",\n  ...,\n  "bin": {\n    "command-name": "jsfile" // path of jsfile relative to package.json\n  },\n  ...\n}\n')]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"6"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"7"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"8"),(0,a._)("br")])],-1),F=(0,a._)("p",null,[(0,a._)("code",null,"commandName"),(0,a.Uk)(" 就是命令的名字，"),(0,a._)("code",null,"jsfile"),(0,a.Uk)(" 就是当用户键入命令时的处理程序。")],-1),H=(0,a._)("p",null,[(0,a.Uk)("3.代码开发。必须在 "),(0,a._)("code",null,"jsfile"),(0,a.Uk)(" 文件的第一行写这行命令 "),(0,a._)("code",null,"#!/usr/bin/env node"),(0,a.Uk)("，譬如：")],-1),O=(0,a._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,a._)("pre",{class:"language-javascript"},[(0,a._)("code",null,[(0,a._)("span",{class:"token hashbang comment"},"#!/usr/bin/env node"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"const"),(0,a.Uk)(" program "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token function"},"require"),(0,a._)("span",{class:"token punctuation"},"("),(0,a._)("span",{class:"token string"},"'commander'"),(0,a._)("span",{class:"token punctuation"},")"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"const"),(0,a.Uk)(" packageJson "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token function"},"require"),(0,a._)("span",{class:"token punctuation"},"("),(0,a._)("span",{class:"token string"},"'../package'"),(0,a._)("span",{class:"token punctuation"},")"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" defaultJsProcessors "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"["),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'react'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"]"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" defaultStyleProcessors "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"["),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'sasslike'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"]"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" defaultWebpackVersion "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'4'"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n"),(0,a._)("span",{class:"token keyword"},"function"),(0,a.Uk)(),(0,a._)("span",{class:"token function"},"parseListArgv"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token parameter"},"val"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token keyword"},"if"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(" val "),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token keyword"},"return"),(0,a.Uk)(" val"),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"split"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"','"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)(),(0,a._)("span",{class:"token keyword"},"else"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token keyword"},"return"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"["),(0,a._)("span",{class:"token punctuation"},"]"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n\nprogram\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"version"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(" packageJson"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("version"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'-v, --version'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"option"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'-u, --use-version <version-number>'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'Webpack version'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"option"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'-j, --js-processors <processors>'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'Specify javascript processors'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(" parseListArgv "),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"option"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'-s, --style-processors <processors>'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'Specify style(css,image,fonts) processors'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(" parseListArgv "),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"option"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'--no-install'"),(0,a._)("span",{class:"token punctuation"},","),(0,a.Uk)(),(0,a._)("span",{class:"token string"},"'Do not install devDependncies package'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token punctuation"},"."),(0,a._)("span",{class:"token function"},"parse"),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(" process"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("argv "),(0,a._)("span",{class:"token punctuation"},")"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" jsProcessors "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(" program"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("jsProcessors "),(0,a._)("span",{class:"token operator"},"||"),(0,a.Uk)(" defaultJsProcessors"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" styleProcessors "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(" program"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("styleProcessors "),(0,a._)("span",{class:"token operator"},"||"),(0,a.Uk)(" defaultStyleProcessors"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token keyword"},"let"),(0,a.Uk)(" webpackVersion "),(0,a._)("span",{class:"token operator"},"="),(0,a.Uk)(" program"),(0,a._)("span",{class:"token punctuation"},"."),(0,a.Uk)("useVersion "),(0,a._)("span",{class:"token operator"},"||"),(0,a.Uk)(" defaultWebpackVersion"),(0,a._)("span",{class:"token punctuation"},";"),(0,a.Uk)("\n\n"),(0,a._)("span",{class:"token keyword"},"if"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"("),(0,a.Uk)(" webpackVersion"),(0,a._)("span",{class:"token operator"},"=="),(0,a._)("span",{class:"token string"},"'4'"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},")"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token comment"},"// code"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)(),(0,a._)("span",{class:"token keyword"},"else"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token comment"},"// code"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"6"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"7"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"8"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"9"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"10"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"11"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"12"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"13"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"14"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"15"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"16"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"17"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"18"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"19"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"20"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"21"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"22"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"23"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"24"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"25"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"26"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"27"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"28"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"29"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"30"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"31"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"32"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"33"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"34"),(0,a._)("br")])],-1),S=(0,a._)("p",null,[(0,a.Uk)("4.当发布成功之后，全局安装刚刚发布的包 "),(0,a._)("code",null,"npm install -g my-cli"),(0,a.Uk)("，安装完以后就可以在命令行使用步骤2中的命令了 "),(0,a._)("code",null,"$ command-name")],-1),X=(0,a._)("h3",{id:"unix-like-平台",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#unix-like-平台","aria-hidden":"true"},"#"),(0,a.Uk)(" Unix-like 平台")],-1),L=(0,a._)("p",null,[(0,a.Uk)("当全局安装 "),(0,a._)("code",null,"npm"),(0,a.Uk)(" 包的时候，"),(0,a._)("code",null,"npm"),(0,a.Uk)(" 会把 "),(0,a._)("code",null,"package.json"),(0,a.Uk)(" 中 "),(0,a._)("code",null,"bin"),(0,a.Uk)(" 配置的 "),(0,a._)("code",null,"command-name"),(0,a.Uk)(" 添加到系统 "),(0,a._)("code",null,"$PATH"),(0,a.Uk)(" 中去。拿 "),(0,a._)("code",null,"macOS"),(0,a.Uk)(" 举例， "),(0,a._)("code",null,"npm"),(0,a.Uk)(" 会在 "),(0,a._)("code",null,"/usr/local/bin"),(0,a.Uk)(" 下创建一个以 "),(0,a._)("code",null,"command-name"),(0,a.Uk)(" 为名字的软链接，指向全局安装下来的 "),(0,a._)("code",null,"my-cli"),(0,a.Uk)(" 包下面的 "),(0,a._)("code",null,"js:jsfile"),(0,a.Uk)("。 （"),(0,a._)("code",null,"/usr/local/bin"),(0,a.Uk)(" 是在 "),(0,a._)("code",null,"$PATH"),(0,a.Uk)(" 中的）")],-1),$=(0,a._)("p",null,[(0,a.Uk)("在命令行键入"),(0,a._)("code",null," command-name"),(0,a.Uk)(" 相当于执行了文本文件 "),(0,a._)("code",null,"jsfile"),(0,a.Uk)("。")],-1),I=(0,a._)("p",null,[(0,a.Uk)("在执行的时候碰到第一行 "),(0,a._)("code",null,"#!/usr/bin/env node"),(0,a.Uk)("，这是一个 "),(0,a._)("code",null,"shebang"),(0,a.Uk)(" 行。这行告诉系统使用 "),(0,a._)("code",null,"node"),(0,a.Uk)(" 去执行当前文件。 （"),(0,a._)("code",null,"shebang"),(0,a.Uk)(" 只有在"),(0,a._)("code",null,"Unix-like"),(0,a.Uk)("平台才有） 执行 "),(0,a._)("code",null,"js"),(0,a.Uk)(" 文件。这里有一个问题："),(0,a._)("code",null,"#!"),(0,a.Uk)(" 并不是一个符合 "),(0,a._)("code",null,"js"),(0,a.Uk)(" 语法的语句，理论上直接执行是会有 "),(0,a._)("code",null,"syntax error"),(0,a.Uk)(" 的。但是 "),(0,a._)("code",null,"node"),(0,a.Uk)(" 对 "),(0,a._)("code",null,"shebang"),(0,a.Uk)(" 行做了例外处理，所以用 "),(0,a._)("code",null,"node"),(0,a.Uk)(" 执行带 "),(0,a._)("code",null,"shebang"),(0,a.Uk)(" 行的 "),(0,a._)("code",null,"js"),(0,a.Uk)(" 文件是没有问题的。")],-1),M=(0,a._)("h3",{id:"windows-平台",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#windows-平台","aria-hidden":"true"},"#"),(0,a.Uk)(" Windows 平台")],-1),G=(0,a._)("p",null,[(0,a.Uk)("全局安装会把包安装到 "),(0,a._)("code",null,"C:\\Users\\username\\AppData\\Roaming\\npm\\node_modules"),(0,a.Uk)("下面， 然后在"),(0,a._)("code",null," C:\\Users\\username\\AppData\\Roaming\\npm"),(0,a.Uk)(" 生成一个 以 "),(0,a._)("code",null,"command-name"),(0,a.Uk)(" 为名字的 "),(0,a._)("code",null,"cmd"),(0,a.Uk)(" 文件："),(0,a._)("code",null,"command-name.cmd"),(0,a.Uk)("。"),(0,a._)("code",null,"（C:\\Users\\username\\AppData\\Roaming\\npm"),(0,a.Uk)(" 在安装 "),(0,a._)("code",null,"npm"),(0,a.Uk)(" 时被加入到 "),(0,a._)("code",null,"%PATH% "),(0,a.Uk)("中） 在 "),(0,a._)("code",null,"Windows"),(0,a.Uk)(" 平台运行 "),(0,a._)("code",null,"cmd"),(0,a.Uk)(" 文件是不需要后缀名的，所以当在命令行键入 "),(0,a._)("code",null,"command-name "),(0,a.Uk)(" 相当于执行 "),(0,a._)("code",null,"C:\\Users\\username\\AppData\\Roaming\\npm\\command-name.cmd"),(0,a.Uk)("。 为什么有这个 "),(0,a._)("code",null,"cmd"),(0,a.Uk)(" 文件，因为 "),(0,a._)("code",null,"windows"),(0,a.Uk)(" 平台没有 "),(0,a._)("code",null,"shebang"),(0,a.Uk)("，那么 "),(0,a._)("code",null,"command-name.cmd"),(0,a.Uk)(" 就模拟了 "),(0,a._)("code",null,"#!/usr/bin/env node"),(0,a.Uk)(" 的功能，调用 "),(0,a._)("code",null,"C:\\Users\\username\\AppData\\Roaming\\npm\\node_modules\\my-cli\\ jsfile")],-1),K=(0,a._)("h3",{id:"本地开发-cli-测试",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#本地开发-cli-测试","aria-hidden":"true"},"#"),(0,a.Uk)(" 本地开发 cli 测试")],-1),Q=(0,a._)("p",null,[(0,a.Uk)("在没有发布到 "),(0,a._)("code",null,"npm"),(0,a.Uk)(" 平台，我们在 "),(0,a._)("code",null,"package.json"),(0,a.Uk)(" 可以添加")],-1),nn=(0,a._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,a._)("pre",{class:"language-json"},[(0,a._)("code",null,[(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n   "),(0,a._)("span",{class:"token property"},'"bin"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"{"),(0,a.Uk)("\n      "),(0,a._)("span",{class:"token property"},'"command-name"'),(0,a._)("span",{class:"token operator"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"jsfile"'),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n"),(0,a._)("span",{class:"token punctuation"},"}"),(0,a.Uk)("\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br")])],-1),sn=(0,a._)("p",null,[(0,a.Uk)("安装一来后然后执行 "),(0,a._)("code",null,"npm init"),(0,a.Uk)(" ,即可本地使用这个命令")],-1),en=(0,a._)("h2",{id:"引用",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#引用","aria-hidden":"true"},"#"),(0,a.Uk)(" 引用")],-1),an={href:"https://segmentfault.com/a/1190000015218126",target:"_blank",rel:"noopener noreferrer"},ln=(0,a.Uk)("npm包来制作命令行工具的原理"),tn=(0,a._)("h2",{id:"今日图-猜猜这个是谁",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#今日图-猜猜这个是谁","aria-hidden":"true"},"#"),(0,a.Uk)(" 今日图 - 猜猜这个是谁？")],-1),on=(0,a._)("p",null,[(0,a._)("img",{src:l,alt:"e5f879a92a3c190ff5e29dd7146f4611.gif"})],-1),cn={render:function(n,s){const e=(0,a.up)("OutboundLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[t,o,(0,a._)("p",null,[c,(0,a._)("a",p,[r,(0,a.Wm)(e)]),_]),u,i,k,d,m,U,b,h,g,f,v,j,y,x,w,A,E,P,R,W,B,D,C,Y,Z,q,z,J,N,T,V,F,H,O,S,X,L,$,I,M,G,K,Q,nn,sn,en,(0,a._)("ul",null,[(0,a._)("li",null,[(0,a._)("a",an,[ln,(0,a.Wm)(e)])])]),tn,on],64)}}},4919:n=>{n.exports="data:image/gif;base64,ZXhwb3J0IGRlZmF1bHQgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyAiODY0ZjFjMmRiYWUzZjc1MzRiOTAyODVkYWU5N2U2ZjkuZ2lmIjs="}}]);